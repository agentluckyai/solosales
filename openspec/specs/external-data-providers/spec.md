# external-data-providers

## 目的

定义外部数据源（M0 RocketReach 为主）的调用方式、审计要求与韧性策略（队列、重试、限流、熔断、降级），保证可观测、可恢复。

## 需求

### 需求: M0 必须真实打通 RocketReach
M0 外部数据源必须以 RocketReach 为主并真实打通（可观测、可审计）。

#### 场景: 真实调用并拿到结果
- **当** 系统对 lead/company 发起抓取
- **那么** 得到结构化结果并通过校验

### 需求: 通过队列执行（重试/限流/暂停）
所有 provider 调用必须通过队列执行，并具备：重试、限流、暂停/恢复。

#### 场景: 队列重试
- **当** provider 暂时失败触发重试
- **那么** 系统最终成功或进入可解释失败态，且不产生重复副作用

### 需求: Provider 审计落库
每次调用必须记录审计字段：provider、参数 hash、耗时、HTTP 状态码、消耗、错误码。

#### 场景: 排查某次 provider 报错
- **当** 工程师查看 provider audit
- **那么** 能定位到具体调用与错误码/耗时/参数 hash

### 需求: 校验 + RocketReach 配额守门/熔断/降级
响应必须校验（例如 Zod）；RocketReach 必须具备配额守门、熔断与降级行为。

#### 场景: 配额耗尽触发降级
- **当** RocketReach quota 接近耗尽
- **那么** 系统触发守门/熔断并采取降级策略，订单流程可暂停/可恢复
